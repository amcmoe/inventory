<!doctype html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="./favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="./apple-touch-icon.png">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline'; img-src 'self' data: blob: https://api.qrserver.com https://*.supabase.co; connect-src 'self' https://*.supabase.co; font-src 'self' data:; media-src 'self' blob:; object-src 'none'; base-uri 'self'; frame-ancestors 'none'; upgrade-insecure-requests">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <title>Inventory - People</title>
  <link rel="stylesheet" href="./styles.css">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div class="title">
          <strong>IT Asset Inventory</strong>
          <span>Team workspace</span>
        </div>
      </div>
      <nav class="nav" id="peopleNav" hidden>
        <a href="./index.html"><span>Search</span></a>
        <div class="nav-group nav-group-admin is-pinned" data-role-min="admin" data-open-default="true">
          <button class="nav-group-toggle" type="button" aria-expanded="true">
            <span>Admin</span>
            <span class="nav-caret" aria-hidden="true">â–¾</span>
          </button>
          <div class="nav-submenu">
            <a class="nav-subitem" href="./admin.html"><span>Asset Management</span></a>
            <a class="nav-subitem active" href="./people.html"><span>User Management</span></a>
          </div>
        </div>
        <a href="./reports.html"><span>Reports</span></a>
      </nav>
    </aside>

    <main class="main">
      <header class="topbar" id="peopleTopbar" hidden>
        <div>
          <h1>User Management</h1>
          <div class="subtext">Manage app access users and assignees.</div>
        </div>
        <div class="controls">
          <button class="btn" id="signOutBtn" type="button">Log Out</button>
        </div>
      </header>

      <section class="panel" id="peopleLoadingPanel">
        <div class="panel-body">
          <h2>Checking Access</h2>
          <p class="muted">Please wait while we verify your session and role.</p>
        </div>
      </section>

      <section class="panel" id="peopleMainSection" hidden>
        <div class="panel-body app-users-panel">
          <div class="app-users-head">
            <h2>Application Access Users</h2>
            <button class="bulk-icon-btn app-refresh-btn" id="refreshAppUsersBtn" type="button" aria-label="Refresh app users" title="Refresh app users">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M21 12a9 9 0 1 1-2.64-6.36" />
                <path d="M21 3v6h-6" />
              </svg>
            </button>
          </div>
          <p class="muted">Create or edit users who can access this inventory application.</p>
          <div class="grid cols-2">
            <div>
              <label for="appUserEmail">User Email</label>
              <input id="appUserEmail" type="email" placeholder="name@school.org">
            </div>
            <div>
              <label for="appUserRole">Role</label>
              <select id="appUserRole">
                <option value="viewer">Viewer</option>
                <option value="tech">Tech</option>
                <option value="admin">Admin</option>
              </select>
            </div>
            <div>
              <label for="appUserName">Display Name (optional)</label>
              <input id="appUserName">
            </div>
          </div>
          <div class="row app-users-actions">
            <button class="btn primary" id="saveAppUserBtn" type="button">Save App User</button>
            <button class="btn" id="inviteAppUserBtn" type="button" hidden>Send Invite</button>
          </div>
          <div class="muted app-user-help" id="appUserHelp">Tip: User must have signed in at least once (or be invited in Supabase Auth) before role can be assigned.</div>
          <div class="table-wrap app-users-table-wrap">
            <table role="grid" aria-label="Application access users">
              <thead>
                <tr>
                  <th>Email</th>
                  <th>Display Name</th>
                  <th>Role</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="appUsersTbody"></tbody>
            </table>
          </div>
        </div>
      </section>

      <section class="panel" id="assigneeSection" hidden>
        <div class="panel-body assignees-panel">
          <h2>Assignees</h2>
          <p class="muted">Look up assignees and edit display names.</p>
          <div class="grid cols-2 assignees-search-block">
            <div>
              <label for="assigneeSearchInput">Search Assignees</label>
              <input id="assigneeSearchInput" type="search" placeholder="Type name, email, employee ID...">
            </div>
          </div>
          <div class="table-wrap assignees-table-wrap">
            <table role="grid" aria-label="Assignees">
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Employee ID</th>
                  <th>Department</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="assigneesTbody"></tbody>
            </table>
          </div>
          <div class="grid cols-2 assignees-edit-block">
            <div>
              <label for="editAssigneeName">Selected Assignee Name</label>
              <input id="editAssigneeName" placeholder="Select an assignee from the table">
            </div>
          </div>
          <div class="row assignees-save-row">
            <button class="btn primary" id="saveAssigneeNameBtn" type="button">Save Assignee Name</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <script src="./config.js"></script>
  <script type="module" src="./js/people.js"></script>
  <button class="theme-toggle-fab" id="themeBtn" type="button" aria-label="Toggle theme">
    <span class="theme-toggle-glyph" aria-hidden="true"></span>
  </button>
</body>
</html>



